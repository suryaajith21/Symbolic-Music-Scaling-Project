# Symbolic Music Scaling Project (Lakh MIDI → ABC)

This repository contains my CS-GY 6923 project: **Scaling Laws for Symbolic Music Modeling**.

I study whether **neural scaling laws** (Kaplan-style power laws) appear in **symbolic music** by training:
- a family of **GPT-style decoder-only Transformers** (Tiny → XL) and
- **LSTM** baselines (Tiny → XL)
on **Lakh MIDI converted to ABC notation**.

I also train a stronger Phase-2 **BEST** model (BPE tokenizer + improved preprocessing) focused on generation quality.

# Sample Examples generated by the 206 million parameter model:
**Listen Here:** (These files and more examples can be found in samples_unconditional\):
These are the 3 samples mentioned in my report pdf:

[GREAT.abc](<https://editor.drawthedots.com/?t=X%3A%201%0AM%3A%204%2F4%0AL%3A%201%2F8%0AQ%3A1%2F4%3D73%0AK%3AC%20%25%200%20sharps%0AV%3A1%0Az8%7C%0A%25%25MIDI%20program%2032%0AC%2C%2C2%20G%2C%2C%3EG%2C%2C%20C%2C2%20C%2C%2C2%7C%0AB%2C%2C%2C2%20%5EF%2C%2C3%2F2z%2F2%20B%2C%2C%2C%3EB%2C%2C%2C%2C%20B%2C%2C2%7C%0AA%2C%2C%2C2%20E%2C%2C3%2F2z%2F2%20A%2C%2C%2C%3EA%2C%2C%20%5EG%2C%2C3%2F2z%2F2%7C%0A%5EF%2C%2C3%2F2z%2F2%20C%2C%2C2%20%5EA%2C%2C%2C2%20D%2C%2C2%7C%0A%5ED%2C%2C2%20G%2C%2C%3EG%2C%2C%20%5EA%2C%2C2%20%3DD%2C%2C2%7C%0AC%2C%2C2%20G%2C%2C%3EG%2C%2C%20C%2C2%20C%2C%2C2%7C%0AB%2C%2C%2C2%20%5EF%2C%2C2%20B%2C%2C%2C%3EB%2C%2C%20B%2C%2C%2C3%2F2z%2F2%7C%0AA%2C%2C%2C3%2F2z%2F2%20E%2C%2C3%2F2z%2F2%20%20(3A%2C%2C%2CA%2C%2C%5EG%2C%2C%20%20(3%3DG%2C%2CF%2C%2CE%2C%2C%7C%0AV%3A2%0Az8%7C%0A%25%25MIDI%20program%200%0A%5Bd-%5EAF%5D8%7C%0A%5BdBG-%5D8%7C%0A%5Be-c-GE-%5D%2F2%5Bec-E-%5D6%5BcE%5D%2F2z%2F2%5B%5Ec%5EAE%5D%2F2%7C%0A%5BdAF%5D8%7C%0A%5B%5Ed-BG%5D8%7C%0A%5B%5Edc-%5EG-F-%5D%2F2%5BcGF%5D%2F2z6z%2F2%5BecG%5D%2F2%7C%0A%5Bf-cA%5D4%20%5Bf-dB%5D4%7C%0A%5Bfe-c-G-%5D%2F2%5Bec-G-%5D3%5BcG%5D%2F2%20z3%2F2%5B%5Edc%5EF%5D%2F2%20%5B%3DdB%3DF%5D%2F2z%5B%5EdcA%5D%2F2%7C%0A%5Be-%5EA-G-%5D6%20%5BeAG%5D%2F2z3%2F2%7C%0A%5Bc-AE%5D4%20%5Bc-BF%5D4%7C%0A%5Bc-cE-%5D4%20%5Bc-AE-%5D3%5BcE%5D%7C%0A%5BgdB-G-%5D%5BB-G-%5D6%5BBG%5D%2F2z%2F2%7C%0A%5B%5Eag%5Ed%5EG%5D%2F2%5B%3Dgec%5EG%5D%2F2z6z%2F2%5Bf%3DdA%5D%2F2%7C%0A%5Bg-%5Ed-c%5D3%2F2%5Bgd%5D%2F2%20%5B%5Egf%3DdG%5D2%20%5B%5Ea-%3Dg%5Edc%5D%5Badc%5D%2F2%5Badc%5D%2F2%20z3%2F2%5B%5Egdc%5D%2F2%7C%0A%5B%5EagcA%5D8%7C%0AV%3A3%0Az8%7C%0A%25%25MIDI%20program%2032%0AC%2C2%20G%2C%2C%3EG%2C%2C%20C%2C2%20C%2C%2C2%7C%0AB%2C%2C%2C2%20%5EF%2C%2C3%2F2z%2F2%20B%2C%2C%2C%3EB%2C%2C%2C%2C%20B%2C%2C2%7C%0AA%2C%2C%2C2%20E%2C%2C3%2F2z%2F2%20A%2C%2C%2C%3EA%2C%2C%20%5EG%2C%2C3%2F2z%2F2%7C%0A%5EF%2C%2C3%2F2z%2F2%20C%2C%2C2%20%5EA%2C%2C%2C2%20D%2C%2C2%7C%0A%5ED%2C%2C2%20G%2C%2C%3EG%2C%2C%20%5EA%2C%2C2%20%3DD%2C%2C2%7C%0AC%2C%2C2%20G%2C%2C%3EG%2C%2C%20C%2C2%20C%2C%2C2%7C%0AB%2C%2C%2C2%20%5EF%2C%2C3%2F2z%2F2%20B%2C%2C%2C%3EB%2C%2C%2C%2C%20B%2C%2C2%7C%0AA%2C%2C%2C2%20E%2C%2C3%2F2z%2F2%20A%2C%2C%2C%3EA%2C%2C%20%5EG%2C%2C3%2F2z%2F2%7C%0A%5EF%2C%2C3%2F2z%2F2%20C%2C%2C2%20%5EA%2C%2C%2C2%20D%2C%2C2%7C%0A%5ED%2C%2C2%20G%2C%2C%3EG%2C%2C%20%5EA%2C%2C2%20%3DD%2C%2C2%7C%0AC%2C%2C2%20G%2C%2C%3EG%2C%2C%20C%2C2%20C%2C%2C2%7C%0AB%2C%2C%2C2%20%5EF%2C%2C3%2F2z%2F2%20B%2C%2C%2C%3EB%2C%2C%2C%2C%20B%2C%2C2%7C%0AA%2C%2C%2C2%20E%2C%2C3%2F2z%2F2%20A%2C%2C%2C%3EA%2C%2C%20%5EG%2C%2C3%2F2z%2F2%7C%0A%5EF%2C%2C3%2F2z%2F2%20C%2C%2C2%20%5EA%2C%2C%2C2%20D%2C%2C2%7C%0A%5ED%2C%2C2%20G%2C%2C%3EG%2C%2C%20%5EA%2C%2C2%20%3DD%2C%2C2%7C%0AC%2C%2C2%20G%2C%2C%3EG%2C%2C%20C%2C2%20C%2C%2C2%7C%0AV%3A4%0A%25%25MIDI%20channel%2010%0Az8%7C%0A%5B%5ED%2C-E%2C%2C%3DD%2C%2CB%2C%2C%2C-%5D%2F2%5B%5ED%2CB%2C%2C%2C%5D%2F2z%20B%2C%2C%2Cz%20%5BD%2CE%2C%2CB%2C%2C%2C%5Dz%2F2%5BE%2C%3DD%2C%2CB%2C%2C%2C%5D%2F2%20z3%2F2%5BE%2C%2CB%2C%2C%2C%5D%2F2%7C%0A%5B%5ED%2CE%2C%2C%3DD%2C%2CB%2C%2C%2C%5D%2F2z3%2F2%20%5B%5ED%2C-E%2C%2C%3DD%2C%2C-B%2C%2C%2C-%5D%5BE%2C-%5ED%2C%3DD%2C%2CB%2C%2C%2C%5D%2F2%5BE%2C%5ED%2C-%3DD%2C%2CB%2C%2C%2C%5D%2F2%20%5ED%2C%2F2-%5BD%2C%3DD%2C%2C%5D%2F2z%2F2%5ED%2C%2F2%20%5BD%2C-E%2C%2C%3DD%2C%2CB%2C%2C%2C-%5D%2F2%5B%5ED%2CB%2C%2C%2C%5D%2F2z%2F2B%2C%2C%2C%2F2%7C%0A%5B%5ED%2C-E%2C%2C%3DD%2C%2CB%2C%2C%2C-%5D%2F2%5B%5ED%2CB%2C%2C%2C%5D%2F2z%20B%2C%2C%2Cz%20%5BD%2CE%2C%2CB%2C%2C%2C%5Dz%2F2%5BE%2C%3DD%2C%2CB%2C%2C%2C%5D%2F2%20z3%2F2%5BE%2C%2CB%2C%2C%2C%5D%2F2%7C%0A%5B%5ED%2CE%2C%2C%3DD%2C%2CB%2C%2C%2C%5D%2F2z3%2F2%20%5B%5ED%2C-E%2C%2C%3DD%2C%2C-B%2C%2C%2C-%5D%2F2%5B%5ED%2C%3DD%2C%2CB%2C%2C%2C%5D%2F2z%2F2%5B%5ED%2C-%3DD%2C%2C%5D%2F2%20%5B%5ED%2CE%2C%2C-%5D%2F2E%2C%2C%2F2z%20%5BD%2CE%2C%2C%3DD%2C%2C-B%2C%2C%2C%5D%2F2D%2C%2C%2F2z%2F2%5BE%2C%2C-B%2C%2C%2C-%5D%2F2%7C%0A%5B%5ED%2CE%2C%2C-%3DD%2C%2CB%2C%2C%2C-%5D%2F2%5BE%2C%2CB%2C%2C%2C%5D%2F2z6z%7C%0A%5BE%2C%2CB%2C%2C%2C%5D%2F2z3%2F2%20B%2C%2C%2C%2F2-%5BE%2C%2CD%2C%2CB%2C%2C%2C%5D%2F2z%2F2B%2C%2C%2C%2F2-%20%5BE%2C%2CD%2C%2CB%2C%2C%2C-%5D%2F2B%2C%2C%2CE%2C%2C%2F2%20%5BE%2C%2CB%2C%2C%2C-%5D%2F2%5BD%2C%2CB%2C%2C%2C%5D%2F2z%2F2E%2C%2C%2F2-%7C%0A%5BE%2C%2CB%2C%2C%2C-%5D%2F2B%2C%2C%2C3%2F2%20%5BE%2C%2CD%2C%2C%5D%2F2zB%2C%2C%2C%2F2-%20%5BE%2C%2CB%2C%2C%2C%5D%2F2zD%2C%2C%2F2%20%5BE%2C%2CB%2C%2C%2C-%5D%2F2B%2C%2C%2C%2F2z%2F2E%2C%2C%2F2%7C%0A%5B%5ED%2CE%2C%2C%3DD%2C%2CB%2C%2C%2C-%5D%2F2B%2C%2C%2Cz%2F2%20%5B%5ED%2C-E%2C%2C%3DD%2C%2C-%5D%2F2%5B%5ED%2C%3DD%2C%2C%5D%2F2z%20%5B%5ED%2CE%2C%2C-B%2C%2C%2C%5D%2F2E%2C%2Cz%2F2%20%5BD%2CE%2C%2C%3DD%2C%2C-%5D%2F2D%2C%2C%2F2z%2F2%5BE%2C%2C-B%2C%2C%2C%5D%2F2%7C%0A%5BE%2C%2C%5ED%2C%2C-%5D%2F2D%2C%2C%2F2z%20B%2C%2C%2C%2F2-%5BE%2C%2CB%2C%2C%2C%5D%2F2z%2F2B%2C%2C%2C%2F2%20%5BE%2C%2CB%2C%2C%2C-%5D%2F2B%2C%2C%2CE%2C%2C%2F2%20D%2C%2C%2F2zE%2C%2C%2F2-%7C%0A%5BE%2C%2CB%2C%2C%2C%5D%2F2z3%2F2%20%5BE%2C%2CD%2C%2C%5D%2F2zB%2C%2C%2C%2F2-%20%5BE%2C%2CB%2C%2C%2C%5D%2F2zD%2C%2C%2F2-%20%5BE%2C%2CD%2C%2C%5D%2F2z%5BE%2C%2CB%2C%2C%2C%5D%2F2%7C%0A%5B%5ED%2CE%2C%2C%3DD%2C%2CB%2C%2C%2C%5D%2F2z3%2F2%20%5B%5ED%2C-E%2C%2C%3DD%2C%2C%5D%2F2%5ED%2C%2F2z%2F2B%2C%2C%2C%2F2%20%5BD%2CE%2C%2C%3DD%2C%2C%5D%2F2z3%2F2%20%5ED%2C%2F2z%3DD%2C%2C%2F2-%7C%0A%5B%5ED%2CE%2C%2C%3DD%2C%2CB%2C%2C%2C%5D%2F2z3%2F2%20%5B%5ED%2CE%2C%2C%3DD%2C%2C%5D%2F2zB%2C%2C%2C%2F2-%20%5B%5ED%2CE%2C%2CB%2C%2C%2C%5D%2F2zD%2C%2C%2F2%20%5BE%2C%2C%3DD%2C%2C-%5D%2F2D%2C%2C%2F2z%2F2%5BE%2C%2C-B%2C%2C%2C%5D%2F2%7C%0A%5BE%2C%2C%5ED%2C%2C-%5D%2F2D%2C%2C%2F2z%20%5BE%2C%2C%3DD%2C%2C%5D%2F2zB%2C%2C%2C%2F2-%20%5B%5ED%2CE%2C%2C%3DD%2C%2CB%2C%2C%2C%5D%2F2z3%2F2%20%5ED%2C%2F2zE%2C%2C%2F2-%7C%0A%5BE%2C%2CB%2C%2C%2C%5D%2F2z3%2F2%20%5BE%2C%2CD%2C%2C%5D%2F2zB%2C%2C%2C%2F2-%20%5BE%2C%2CB%2C%2C%2C%5D%2F2z3%2F2%20D%2C%2C%2F2zz%2F2%7C%0A%5B%5EC%2C-E%2C%2C-%3DC%2C%2CB%2C%2C%2C-%5D%2F2%5B%5EC%2CE%2C%2CB%2C%2C%2C%5D%2F2z%20C%2C%2F2-%5BC%2CE%2C%2C-%5D%2F2E%2C%2C%2F2B%2C%2C%2C%2F2-%20%5BC%2CE%2C%2CB%2C%2C%2C%5D%2F2zD%2C%2C%2F2-%20%5BC%2CE%2C%2CD%2C%2C%5D%2F2zB%2C%2C%2C%2F2%7C%0A%5B%5ED%2CE%2C%2C%3DD%2C%2C-B%2C%2C%2C%5D%2F2D%2C%2C%2F2z%20%5ED%2C%2F2-%5BD%2C%3DD%2C%2C%5D%2F2z%2F2B%2C%2C%2C%2F2%20%5B%5ED%2CE%2C%2C%3DD%2C%2C%5D%2F2z3%2F2%20%5ED%2C%2F2zE%2C%2C%2F2-%7C%0A%5BE%2C%2CB%2C%2C%2C%5D%2F2z3%2F2%20%5BE%2C%2CD%2C%2C%5D%2F2zz%2F2%20B%2C%2C%2C3%2F2z%2F2%20D%2C%2C%2F2zz%2F2%7C%0A%5B%5EC%2C-E%2C%2C-%3DC%2C%2CB%2C%2C%2C-%5D%2F2%5B%5EC%2CE%2C%2CB%2C%2C%2C%5D%2F2z%20C%2C%2F2-%5BC%2CE%2C%2C-%5D%2F2E%2C%2C%2F2z%2F2%20%5BC%2CE%2C%2CB%2C%2C%2C%5D%2F2z3%2F2%20%5BC%2CE%2C%2C%5D%2F2zB%2C%2C%2C%2F2%7C%0A%5B%5EC%2CE%2C%2C%3DC%2C%2CB%2C%2C%2C%5D%2F2z3%2F2%20C%2C%2F2z3%2F2%20%5BC%2CE%2C%2C-B%2C%2C%2C%5D%2F2E%2C%2C%2F2z%20%5BC%2CE%2C%2C-B%2C%2C%2C%5D%2F2%5BE%2C%2CB%2C%2C%2C%5D%2F2z%2F2%5BA%2C%2C-B%2C%2C%2C%5D%2F2%7C%0A%5BA%2C%2CE%2C%2CB%2C%2C%2C%5D%2F2z3%2F2%20%5B%5ED%2CE%2C%2C%5D%2F2zz%2F2%20%5BD%2CE%2C%2CB%2C%2C%2C%5D%2F2z3%2F2%20%5BD%2CE%2C%2C%5D%2F2zz%2F2%7C%0A%5B%5ED%2CE%2C%2C-%3DD%2C%2CB%2C%2C%2C-%5D%2F2%5BE%2C%2CB%2C%2C%2C%5D%2F2z%20%5EC%2C%2F2-%5BC%2CE%2C%2C-%5D%2F2E%2C%2C%2F2z%2F2%20%5BD%2CE%2C%2C-B%2C%2C%2C%5D%2F2E%2C%2C%2F2z%20%5BD%2CE%2C%2C%5D%2F2z%5BD%2C-E%2C%2C-%3DD%2C%2CB%2C%2C%2C%5D%2F2%7C%0A%5B%5ED%2CE%2C%2C%3DD%2C%2CB%2C%2C%2C%5D%2F2z3%2F2%20%5B%5ED%2C%3DD%2C%2C%5D%2F2z3%2F2%20%5B%5ED%2CE%2C%2C-%3DD%2C%2C%5D%2F2E%2C%2C%2F2z%20%5B%5ED%2CE%2C%2C-%5D%2F2E%2C%2C%2F2z%2F2%5BD%2CE%2C%2C-B%2C%2C%2C%5D%2F2%7C%0A%5B%5ED%2CE%2C%2CB%2C%2C%2C%5D%2F2z3%2F2%20%5BD%2CE%2C%2C%5D%2F2zz%2F2%20%5BD%2CE%2C%2CB%2C%2C%2C%5D%2F2zD%2C%2F2%20%5BD>)

[Good_1.abc](<https://editor.drawthedots.com/?t=X:+1%0AM:+4/4%0AL:+1/8%0AQ:1/4=73%0AK:C+%25+0+sharps%0AV:1%0Az8|%0A%25%25MIDI+program+32%0AC,,2+G,,%3EG,,+C,2+C,,2|%0AB,,,2+^F,,3/2z/2+B,,,%3EB,,,,+B,,2|%0AA,,,2+E,,3/2z/2+A,,,%3EA,,+^G,,3/2z/2|%0A^F,,3/2z/2+C,,2+^A,,,2+D,,2|%0A^D,,2+G,,%3EG,,+^A,,2+=D,,2|%0AC,,2+G,,%3EG,,+C,2+C,,2|%0AB,,,2+^F,,2+B,,,%3EB,,+B,,,3/2z/2|%0AA,,,3/2z/2+E,,3/2z/2++(3A,,,A,,^G,,++(3=G,,F,,E,,|%0AV:2%0Az8|%0A%25%25MIDI+program+0%0A[d-^AF]8|%0A[dBG-]8|%0A[e-c-GE-]/2[ec-E-]6[cE]/2z/2[^c^AE]/2|%0A[dAF]8|%0A[^d-BG]8|%0A[^dc-^G-F-]/2[cGF]/2z6z/2[ecG]/2|%0A[f-cA]4+[f-dB]4|%0A[fe-c-G-]/2[ec-G-]3[cG]/2+z3/2[^dc^F]/2+[=dB=F]/2z[^dcA]/2|%0A[e-^A-G-]6+[eAG]/2z3/2|%0A[c-AE]4+[c-BF]4|%0A[c-cE-]4+[c-AE-]3[cE]|%0A[gdB-G-][B-G-]6[BG]/2z/2|%0A[^ag^d^G]/2[=gec^G]/2z6z/2[f=dA]/2|%0A[g-^d-c]3/2[gd]/2+[^gf=dG]2+[^a-=g^dc][adc]/2[adc]/2+z3/2[^gdc]/2|%0A[^agcA]8|%0AV:3%0Az8|%0A%25%25MIDI+program+32%0AC,2+G,,%3EG,,+C,2+C,,2|%0AB,,,2+^F,,3/2z/2+B,,,%3EB,,,,+B,,2|%0AA,,,2+E,,3/2z/2+A,,,%3EA,,+^G,,3/2z/2|%0A^F,,3/2z/2+C,,2+^A,,,2+D,,2|%0A^D,,2+G,,%3EG,,+^A,,2+=D,,2|%0AC,,2+G,,%3EG,,+C,2+C,,2|%0AB,,,2+^F,,3/2z/2+B,,,%3EB,,,,+B,,2|%0AA,,,2+E,,3/2z/2+A,,,%3EA,,+^G,,3/2z/2|%0A^F,,3/2z/2+C,,2+^A,,,2+D,,2|%0A^D,,2+G,,%3EG,,+^A,,2+=D,,2|%0AC,,2+G,,%3EG,,+C,2+C,,2|%0AB,,,2+^F,,3/2z/2+B,,,%3EB,,,,+B,,2|%0AA,,,2+E,,3/2z/2+A,,,%3EA,,+^G,,3/2z/2|%0A^F,,3/2z/2+C,,2+^A,,,2+D,,2|%0A^D,,2+G,,%3EG,,+^A,,2+=D,,2|%0AC,,2+G,,%3EG,,+C,2+C,,2|%0AV:4%0A%25%25MIDI+channel+10%0Az8|%0A[^D,-E,,=D,,B,,,-]/2[^D,B,,,]/2z+B,,,z+[D,E,,B,,,]z/2[E,=D,,B,,,]/2+z3/2[E,,B,,,]/2|%0A[^D,E,,=D,,B,,,]/2z3/2+[^D,-E,,=D,,-B,,,-][E,-^D,=D,,B,,,]/2[E,^D,-=D,,B,,,]/2+^D,/2-[D,=D,,]/2z/2^D,/2+[D,-E,,=D,,B,,,-]/2[^D,B,,,]/2z/2B,,,/2|%0A[^D,-E,,=D,,B,,,-]/2[^D,B,,,]/2z+B,,,z+[D,E,,B,,,]z/2[E,=D,,B,,,]/2+z3/2[E,,B,,,]/2|%0A[^D,E,,=D,,B,,,]/2z3/2+[^D,-E,,=D,,-B,,,-]/2[^D,=D,,B,,,]/2z/2[^D,-=D,,]/2+[^D,E,,-]/2E,,/2z+[D,E,,=D,,-B,,,]/2D,,/2z/2[E,,-B,,,-]/2|%0A[^D,E,,-=D,,B,,,-]/2[E,,B,,,]/2z6z|%0A[E,,B,,,]/2z3/2+B,,,/2-[E,,D,,B,,,]/2z/2B,,,/2-+[E,,D,,B,,,-]/2B,,,E,,/2+[E,,B,,,-]/2[D,,B,,,]/2z/2E,,/2-|%0A[E,,B,,,-]/2B,,,3/2+[E,,D,,]/2zB,,,/2-+[E,,B,,,]/2zD,,/2+[E,,B,,,-]/2B,,,/2z/2E,,/2|%0A[^D,E,,=D,,B,,,-]/2B,,,z/2+[^D,-E,,=D,,-]/2[^D,=D,,]/2z+[^D,E,,-B,,,]/2E,,z/2+[D,E,,=D,,-]/2D,,/2z/2[E,,-B,,,]/2|%0A[E,,^D,,-]/2D,,/2z+B,,,/2-[E,,B,,,]/2z/2B,,,/2+[E,,B,,,-]/2B,,,E,,/2+D,,/2zE,,/2-|%0A[E,,B,,,]/2z3/2+[E,,D,,]/2zB,,,/2-+[E,,B,,,]/2zD,,/2-+[E,,D,,]/2z[E,,B,,,]/2|%0A[^D,E,,=D,,B,,,]/2z3/2+[^D,-E,,=D,,]/2^D,/2z/2B,,,/2+[D,E,,=D,,]/2z3/2+^D,/2z=D,,/2-|%0A[^D,E,,=D,,B,,,]/2z3/2+[^D,E,,=D,,]/2zB,,,/2-+[^D,E,,B,,,]/2zD,,/2+[E,,=D,,-]/2D,,/2z/2[E,,-B,,,]/2|%0A[E,,^D,,-]/2D,,/2z+[E,,=D,,]/2zB,,,/2-+[^D,E,,=D,,B,,,]/2z3/2+^D,/2zE,,/2-|%0A[E,,B,,,]/2z3/2+[E,,D,,]/2zB,,,/2-+[E,,B,,,]/2z3/2+D,,/2zz/2|%0A[^C,-E,,-=C,,B,,,-]/2[^C,E,,B,,,]/2z+C,/2-[C,E,,-]/2E,,/2B,,,/2-+[C,E,,B,,,]/2zD,,/2-+[C,E,,D,,]/2zB,,,/2|%0A[^D,E,,=D,,-B,,,]/2D,,/2z+^D,/2-[D,=D,,]/2z/2B,,,/2+[^D,E,,=D,,]/2z3/2+^D,/2zE,,/2-|%0A[E,,B,,,]/2z3/2+[E,,D,,]/2zz/2+B,,,3/2z/2+D,,/2zz/2|%0A[^C,-E,,-=C,,B,,,-]/2[^C,E,,B,,,]/2z+C,/2-[C,E,,-]/2E,,/2z/2+[C,E,,B,,,]/2z3/2+[C,E,,]/2zB,,,/2|%0A[^C,E,,=C,,B,,,]/2z3/2+C,/2z3/2+[C,E,,-B,,,]/2E,,/2z+[C,E,,-B,,,]/2[E,,B,,,]/2z/2[A,,-B,,,]/2|%0A[A,,E,,B,,,]/2z3/2+[^D,E,,]/2zz/2+[D,E,,B,,,]/2z3/2+[D,E,,]/2zz/2|%0A[^D,E,,-=D,,B,,,-]/2[E,,B,,,]/2z+^C,/2-[C,E,,-]/2E,,/2z/2+[D,E,,-B,,,]/2E,,/2z+[D,E,,]/2z[D,-E,,-=D,,B,,,]/2|%0A[^D,E,,=D,,B,,,]/2z3/2+[^D,=D,,]/2z3/2+[^D,E,,-=D,,]/2E,,/2z+[^D,E,,-]/2E,,/2z/2[D,E,,-B,,,]/2|%0A[^D,E,,B,,,]/2z3/2+[D,E,,]/2zz/2+[D,E,,B,,,]/2zD,/2+[D>)

[Good_1.abc](<https://editor.drawthedots.com/?t=X:+1%0AM:+4/4%0AL:+1/8%0AQ:1/4=120%0AK:Ab+%25+4+flats%0AV:1%0A%25%25clef+treble%0Az6+z3/2[eE,,-]/2|%0AE,,3/2-[e-c-=A_GE,,][ecE,-]/2[e-c-G-E,]/2[ecG]/2+G,/2z/2[=e_d_AB,,]2D,/2-[=A-F-=D,-_D,]/2|%0A[=AF-D,][FA,A,,]/2z/2+[_AE=B,-C,-][B,C,-]/2[=AG=EC,]C,,/2[_A-_E_B,=E,-]+[AE,-]/2[EE,F,,-]/2[=AA,_E,F,,-]|%0AF,,-[B,,-F,,-]/2[EB,G,B,,F,,-]/2+F,,/2-[C,-=A,,-F,,-][G-=E-B,G,C,-A,,F,,][GEE,-C,E,,-]/2[E,E,,-]+E,,/2-[D,-E,,D,,-]/2[F_DA,=D,D,,]|%0A[D,-G,,]/2[=AF_DA,D,]/2z/2=D,,-[AFA,D,D,,-][FDA,D,-D,,-]/2+[D,-A,,-D,,-]/2[_ADA,=D,A,,D,,-]/2D,,/2-[G-D-=B,-G,-_D,,]/2+[GD-B,-G,-]/2[DB,G,D,_G,,]/2z/2_E,,/2|%0AG,,,2-+[_G-=D-=A,-=E,-][GDA,E,E,,,]/2_E,,,-[=GE,,,-]/2[A_GD=G,E,,,-]3/2[E,,-E,,,]/2[B-_GC-=E,,-]|%0A[=BC-=E,,-_E,,]/2[cC=E,,-][E,,_E,,-]E,,-[A-_G-C-=G,-E,,][AGCG,D,,-]/2D,,+z/2[_BF_D_A,F,,-][BDA,F,,]/2|%0Az/2E,/2-[A=EB,_E,-]+[E,D,-]/2[=AFD=B,_D,]A,,/2+[=AF=DB,=G,,]2+_B,,3/2-[B-_GE-C-_A,-B,,-]/2|%0A[=B-EC_A,B,,]B+B,,,/2=B,,,2-[_B-GE-=B,_B,,,-]/2[BEB,,-B,,,]/2B,,-[=B-A-E-_B,-_B,,B,,,-][B=AEB,B,,-B,,,]/2|%0A=B,,-[_BG=E_D=B,B,,-]+[B,,B,,,-]/2B,,,-[BA=EDB,,,]B,,-[A_G_D-A,B,,]/2+D/2zB,,,/2-|%0A[_dB,,,-]B,,,/2-[=dG=EB,,,]/2+[=AA,,,-]/2A,,,-[c-G-_E-C-A,,,][cGE-C-]/2[EC]/2z/2+_A,,,3/2-[AF-=B,-A,-=A,,,-]/2|%0A[F=B,_A,=A,,,-]/2[F,,A,,,][F-DB,]/2+F/2B,,,-[G-DB,B,,,-][GF,,-B,,,-]/2[F,,B,,,-]/2[=ED-A,_B,,,-][=EDB,,B,,,]/2_G,,/2D,,/2-|%0AD,,-[=B,D,,-]/2[=AE-A,-D,,]/2+[EA,]G,,/2-[_DG,,-][F-=DA,-G,,][FA,G,,]/2+_G,,/2%3E=E,,/2[_AE]/2z/2|%0A[_AA,,,-]3/2A,,,/2+[=A=EDA,,-]A,,+E,,3/2-[A_A=E-_DE,,]E/2-[E=E,,]/2[_GD,,-]/2|%0AD,,-[BB,D,,]/2[=A_D,,-]/2+D,,/2-[=BG-D-D,,-]/2[GDD,,]/2D,-[E-D,-]/2[=dA-ED,]+[AG,,]/2z/2[c-G-]/2[cGC,,-]/2|%0AC,,-[=BD-C,,]/2[A-_G-DC,-][AGC,-B,,,-]/2[B,-C,B,,,]/2B,/2-+[d=GB,]/2A,,,/2z/2[dB]/2+A,,,-[e-A,,,-]|%0A[ed-=B-AA,,,]/2[dB]/2A,,+[_gd=AGA,,,]2+B,,,3/2-[A-EB,,,-][AB,,-B,,,]/2[_G_B,-=B,,-]|%0A[B,-E,=B,,]/2B,/2[DA,A,,]/2A,,,3/2-[_B,G,A,,,-]3/2[=B,-A,-A,,,][B,A,A,,-]/2+[A,,_D,,-]/2D,,/2-[=E-D,,-]/2[AE=DA,_D,,-]/2|%0A_D,,[=B,-_B,-]/2[G=B,-_B,]/2+[=B,A,,]/2z/2[_B-_G-D-]/2[BGDA,,,-]/2+A,,,-[BA,,-A,,,]+[B,A,,=D,,-]3/2[AA,-D,,]/2|%0AA,/2-[A,A,,]G,,3/2-[A-=E-DG,,-]/2[AEA,G,,]/2+_E,,-[A-_G-C-E,,]+[AGC=G,,-][B,-G,,-]/2[B,-G,,-B,,,]/2|%0A[=B,-_B,=G,,]/2=B,/2_G,,/2_B,,,3/2-[A-F-=B,_B,,,-]+[AF=B,,,_B,,,-][B,,,B,,,,]/2z/2+[_BG-D=B,]G/2_B,,,/2-|%0AB,,,-[AA,B,,,-]/2B,,,/2+=B,,%3E_B,,+[=B-G-E-]/2[BGE_D,,-]/2D,,-+[AD,,-]D,,/2[_B,-=D,,-]/2|%0A[=B,D,,][_BD,,-]+D,,/2-[=B,D,,]/2_E,,/2-[_B=AED,,-][D,-D,,]D,/2+_D,,3/2[=A-_G-C-]/2|%0A[AGC-D,,-]3/2[C-CA,,-D,,-]/2+[CA,,-D,,-]/2[A,,D,,]z/2+=B,,-[eB,,-]+B,,-[_e-_d-B-=DB,,]/2[e-_dB-]/2|%0A[e=BA,,,]/2z3/2+[AE]z+[_dE-]E-+[=d-BE]/2d/2-[d=B]/2z/2|%0AA,,,/2z3/2+[_DA,]/2zz/2+z[dE-]/2E-[=d-BED-]/2[dD]/2=B/2-|%0A=B/2z/2_B/2[AD-]/2+D/2z/2_G/2-[G=G,-]/2+G,/2A,,3/2-+[dA,,-]A,,/2-[_d-B-GA,,]/2|%0A[_dB]/2z/2=D,,-+[B-DD,,-]/2[BD,,-]/2D,,+[=B,-D,,-][EB,D,,-]/2[GD,,]3/2[AE,,-]/2E,,/2-|%0AE,,-[d-=BE-_DE,,]/2[=dE]/2+z[A,G,]/2[AE]3/2D/2z3/2[eB]/2z/2|%0AzG/2%3CD/2+_D%3E=B,,+=D,,-[_ED,,-]/2[G-D,,]3/2G/2-[G=EDB,]/2|%0AzC,/2-[DC,-]/2+C,-[=EC,-]+C,/2-[_GC,]3/2+_A,,3/2=B,,,/2-|%0A=B,,,-[DB,,,-]/2[_GB,,,-]B,,,/2-[=G,,-B,,,]/2G,,/2+D,,-[E_B,D,,-]+[G-D,,][GE,,-]/2E,,/2-|%0A[=E,,_E,,]/2[=ED-_A,][D-=A,A,,-]/2+[DA,,-]/2A,,/2-[G,-A,,-]/2[DG,-A,,-][G-G,-A,,]2[GG,-A,,-][_EG,A,,-=A,,G,,]/2|%0AA,,/2z2[FB,-_A,-]3/2+[_GB,-A,-][B,A,]/2G-[=BA-GA,-]/2[AA,-]/2[_dA,-]/2|%0A_A,/2-[_eGA,-D,-]/2[A,D,]+d=B+_d/2z/2[=dD]/2e/2+z[=eA]/2z/2|%0Az/2g/2[a-_dA-]+[aA-]/2[gA]3/2+A%3EF+E-[_AE-]/2E/2-|%0A[AE-_DE,,-]/2[EE,,-][ADE,,]/2+A,,-[AE-C-A,,-]+[E-C-A,,]3/2[ECA,,,-]3/2[B,,,A,,,]/2z/2|%0Az4+z[_GDA,]/2zD,/2-[=GD,]|%0A[B_AA,-]A,+B,-[B,=A,-]/2A,-[_G-_D-A,-B,,-][GDB,-A,-B,,-]/2+[_A=B,_A,-B,,-]/2[A,-B,,][A-=ED-A,-]/2|%0A[_AD_A,]A,/2-[A,E,-]/2+E,[A,-D,-]+[G-DA,-D,-][=A-_AGA,-D,-]/2[=AG-_A,-D,]/2+[GA,-]A>)


---

## Key results

### Scaling behavior
- Symbolic music modeling shows power-law scaling with an exponent **α ≈ 0.08**.
- **LSTMs** are more sample-efficient below ~**5M params**, but **Transformers** scale better beyond that.

### BEST model evaluation
- **Test perplexity:** 1.9336  
- **Syntactic validity:** 68.0% (music21 parses generated ABC)  
- **ABC → MIDI success:** 58.8% (music21 MIDI export succeeds)

---

## Repository structure

```text
Symbolic-Music-Scaling-Project/
src/ # Phase 1: scaling study scripts (char-level)
Best Model/
src/ # Phase 2: BEST model preprocessing + tokenizer + generation scripts
notebooks/ # Colab notebooks (training + evaluation)
unconditional_generation_samples/ # Example unconditional generations (.abc)
conditional generation samples/ # Example prompted/conditional generations (.abc)
requirements.txt
README.md
```

### Folder structure

### Folder structure

### Phase 1 — Scaling Study (`src/`)
Typical contents:
- `process_data.py` : Phase-1 preprocessing / dataset construction
- `model.py`, `config.py` : model/config helpers
- `plot.py`, `plot_train.py` : plotting scaling + training curves
- `conversion_stats.py`, `count_tokens.py`, `report_data.py` : stats + reporting helpers

### Phase 2 — BEST Model (`Best Model/src/`)
Typical contents:
- `gzip_stats.py` : gzip-ratio diagnostics
- `process_safe.py` : improved cleaning + filtering pipeline
- `split_songs.py` : song splitting utilities
- `train_tokenizer.py` : train BPE tokenizer (vocab 4096)
- `tokenize_to_bin.py` : tokenize dataset into training-ready format
- `generate_unconditional.py`, `generate_local.py` : generation scripts
- `count_tokens.py` : token counting for Phase 2 corpora

### Colab notebooks (`notebooks/`)
- `Music_Scaling.ipynb` : scaling study runs
- `TRAIN_BEST_MODEL.ipynb` : BEST model training
- `Perplexity.ipynb` : evaluation notebook(s)
- `01_data.ipynb` : File download

---

## Setup

Create an environment and install dependencies:

```bash
python -m venv .venv
# Windows:
.venv\Scripts\activate
# macOS/Linux:
source .venv/bin/activate

pip install -r requirements.txt
```

---

## Data

This repo does not include the raw Lakh MIDI dataset, converted ABC corpora, or large training artifacts.
You must download Lakh MIDI separately and convert MIDI → ABC (e.g., using midi2abc or music21) like shown in 'notebooks\01_data.ipynb'.

---

## Phase 1: Scaling Study (character-level)

Goal: fit a scaling curve by training multiple model sizes under a fixed compute/token budget.

### Training budget (Phase 1)
- MAX_TRAIN_TOKENS = 100,000,000
- BATCH_SIZE = 64, BLOCK_SIZE = 256
- Tokens/step = 64 × 256 = 16,384
- Total steps = ⌊100,000,000 / 16,384⌋ = 6,103 steps

## How to run (Phase 1)
- Convert MIDI → ABC and point your preprocessing script at your local ABC directory.
- Run Phase-1 preprocessing to build train/val/test text files.
- Train Tiny → XL models (training was run on Colab in this project; see notebooks/).
- Use src/plot.py / src/plot_train.py to reproduce scaling plots and training curves.
- Note: GPT-style training is based on nanoGPT with modifications for ABC preprocessing/tokenization.

---

## Phase 2: BEST Model (BPE + improved preprocessing)

Goal: improve generation quality by fixing Phase-1 failure modes and using a BPE tokenizer.

### Phase-2 pipeline summary
- Gzip-ratio quality filtering: keep file if gzip_bytes / raw_bytes >= 0.24
- Leading-silence trimming: trims rest-heavy leading lines to reduce silence loops
- Explicit song delimiter: each song ends with \n<|endoftext|>\n
- BPE tokenizer: vocab size 4096
- BEST model: ~206M parameters, context window 1024, trained 11,000 steps

## How to run (Phase 2)
```bash
python "Best Model/src/gzip_stats.py"
python "Best Model/src/process_safe.py"
python "Best Model/src/train_tokenizer.py"
python "Best Model/src/tokenize_to_bin.py"
```

Then train on Colab:
notebooks/TRAIN_BEST_MODEL.ipynb

---

## Generating samples

### Unconditional generation
Script: Best Model/src/generate_unconditional.py

Example outputs: unconditional_generation_samples/

## Conditional / prompted generation
Script: Best Model/src/generate_local.py

Example outputs: conditional generation samples/

---

## Model configurations (report)

### Transformers (GPT-style):
- Tiny: 0.8M (4 layers, d=128, 4 heads, vocab 64)
- Small: 4.8M (6 layers, d=256, 8 heads, vocab 64)
- Medium: 21.4M (12 layers, d=384, 6 heads, vocab 64)
- Large: 50.5M (16 layers, d=512, 8 heads, vocab 64)
- XL: 113.5M (16 layers, d=768, 12 heads, vocab 64)
- BEST: 206M (16 layers, d=1024, 16 heads, vocab 4096)

### LSTM baselines:
- Tiny: ~1.07M
- Small: ~5.06M
- Medium: ~19.45M
- Large: ~49.14M
- XL: ~100.20M

---

## References
- Kaplan et al. (2020) — Scaling Laws for Neural Language Models
- Radford et al. (2019) — GPT-2
- Karpathy (2022) — nanoGPT
- Raffel (2016) — Lakh MIDI Dataset (LMD)
